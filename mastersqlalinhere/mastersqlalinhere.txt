-- Social Sentry Master SQL File
-- This file contains the schema for the application as defined in DatabaseService.cs.
-- Use this to restore the database if it is deleted.

-- 1. Settings (Encryption / Config)
CREATE TABLE IF NOT EXISTS Settings (
    Key TEXT PRIMARY KEY,
    Value TEXT,
    EncryptionSalt TEXT
);

-- 2. Rules (Blocking & Limits)
CREATE TABLE IF NOT EXISTS Rules (
    Id INTEGER PRIMARY KEY AUTOINCREMENT,
    Type TEXT, -- 'App', 'Url', 'Title'
    Value TEXT,
    Category TEXT,
    Action TEXT, -- 'Block', 'Limit'
    LimitSeconds INTEGER,
    ScheduleJson TEXT
);

-- 3. Activity Log (Granular)
CREATE TABLE IF NOT EXISTS ActivityLog (
    LogId INTEGER PRIMARY KEY AUTOINCREMENT,
    Timestamp TEXT NOT NULL,
    ProcessName TEXT NOT NULL,
    ProcessId INTEGER,
    WindowTitle TEXT,
    Url TEXT,
    DurationSeconds INTEGER,
    Category TEXT
);

-- 4. Daily Stats (Aggregated)
CREATE TABLE IF NOT EXISTS DailyStats (
    Date TEXT,
    ProcessName TEXT,
    Category TEXT,
    TotalSeconds INTEGER,
    PRIMARY KEY (Date, ProcessName)
);
