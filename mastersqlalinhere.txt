CREATE TABLE IF NOT EXISTS Settings (
    Key TEXT PRIMARY KEY,
    Value TEXT,
    EncryptionSalt TEXT
);

CREATE TABLE IF NOT EXISTS Rules (
    Id INTEGER PRIMARY KEY AUTOINCREMENT,
    Type TEXT, -- 'App', 'Url', 'Title'
    Value TEXT,
    Category TEXT,
    Action TEXT, -- 'Block', 'Limit'
    LimitSeconds INTEGER,
    ScheduleJson TEXT
);

CREATE TABLE IF NOT EXISTS ActivityLog (
    LogId INTEGER PRIMARY KEY AUTOINCREMENT,
    Timestamp TEXT NOT NULL,
    ProcessName TEXT NOT NULL,
    ProcessId INTEGER,
    WindowTitle TEXT,
    Url TEXT,
    DurationSeconds INTEGER,
    Category TEXT,
    Metadata TEXT
);

CREATE TABLE IF NOT EXISTS DailyStats (
    Date TEXT,
    ProcessName TEXT,
    Category TEXT,
    TotalSeconds INTEGER,
    PRIMARY KEY (Date, ProcessName)
);

CREATE TABLE IF NOT EXISTS HourlyStats (
    Date TEXT,
    Hour INTEGER,
    ProcessName TEXT,
    Category TEXT,
    TotalSeconds REAL,
    PRIMARY KEY (Date, Hour, ProcessName)
);

CREATE TABLE IF NOT EXISTS ClassificationRules (
    Id INTEGER PRIMARY KEY AUTOINCREMENT,
    Pattern TEXT,
    MatchType TEXT, -- 'Contains', 'Exact', 'Regex'
    Category TEXT,
    Priority INTEGER
);
