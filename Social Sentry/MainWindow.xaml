<Window x:Class="Social_Sentry.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Social_Sentry"
        xmlns:vm="clr-namespace:Social_Sentry.ViewModels"
        xmlns:views="clr-namespace:Social_Sentry.Views"
        mc:Ignorable="d"
        Title="Social Sentry" Height="700" Width="1000"
        Background="{DynamicResource WindowBackgroundBrush}"
        Icon="Images/app.ico"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="False"
        BorderBrush="{DynamicResource CardBackgroundBrush}"
        BorderThickness="1">
    


    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32"  
                      ResizeBorderThickness="4" 
                      GlassFrameThickness="-1" 
                      CornerRadius="0"
                      NonClientFrameEdges="None"
                      UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <!-- Title Bar Button Style -->
        <Style x:Key="TitleBarButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{DynamicResource PressedBackgroundBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="TitleBarCloseButtonStyle" TargetType="Button" BasedOn="{StaticResource TitleBarButtonStyle}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E81123"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#B30D1B"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Custom Title Bar -->
        <Grid x:Name="AppTitleBar" Grid.Row="0" Height="32" Background="{DynamicResource WindowBackgroundBrush}" Visibility="Visible">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- App Title -->
            <StackPanel Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                 <Image Source="Images/AppLogo.png" Width="16" Height="16" Margin="0,0,8,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                 <TextBlock Text="Social Sentry" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}"/>
            </StackPanel>

            <!-- Window Controls -->
            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click">
                    <Path Data="M0,8 H10" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1" Width="10" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeButton_Click">
                    <Path Data="M0,0 H10 V10 H0 Z" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1" Fill="Transparent" Width="10" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Style="{StaticResource TitleBarCloseButtonStyle}" Click="CloseButton_Click">
                    <Path Data="M0,0 L10,10 M0,10 L10,0" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1" Width="10" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/> <!-- Sidebar -->
                <ColumnDefinition Width="*"/>   <!-- Content -->
            </Grid.ColumnDefinitions>
    
            <!-- Sidebar -->
            <Border Grid.Column="0" Background="{DynamicResource CardBackgroundBrush}" Padding="16">
                <StackPanel>
                    <!-- Logo Area -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,32">
                        <!-- App Logo -->
                        <Border Width="36" Height="36" Margin="0,0,12,0" CornerRadius="8" Background="#1A00E676" Padding="4">
                            <Image Source="Images/AppLogo.png" Stretch="Uniform"/>
                        </Border>
                        
                        <TextBlock Text="Social Sentry" 
                                   Foreground="{DynamicResource PrimaryTextBrush}" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"/>
                        
                        <!-- Enhanced Toggle Button -->
                        <ToggleButton IsChecked="{Binding IsTrackingEnabled}" 
                                      Style="{StaticResource ModernToggleStyle}"
                                      VerticalAlignment="Center"
                                      ToolTip="Toggle Tracking On/Off"
                                      Cursor="Hand"/>
                    </StackPanel>
    
                    <!-- Menu Items -->
                    <Button Content="Dashboard" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Dashboard" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Dashboard'}"/>
                            
                    <Button Content="Categories" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Categories" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Categories'}"/>
                            
                    <Button Content="Usage Limits" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Limit" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Limit'}"/>
                            
                    <Button Content="Raw Data" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Raw" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Raw'}"
                            Visibility="{Binding IsDeveloperModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            
                    <Button Content="Community" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Community" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Community'}"/>
                            
                     <Button Content="All Features" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="AllFeatures" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='AllFeatures'}"/>

                    <Button Content="Prime Mode" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Prime" 
                            Style="{StaticResource NavigationButtonStyle}"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Prime'}"/>
    
                    <Separator Background="#333" Margin="0,16"/>
    
                    <!-- Bottom Items -->
                    <Button Content="Settings" 
                            Command="{Binding NavigateCommand}" 
                            CommandParameter="Settings" 
                            Style="{StaticResource NavigationButtonStyle}" 
                            VerticalAlignment="Bottom"
                            Tag="{Binding CurrentPageName, Converter={StaticResource EqualConverter}, ConverterParameter='Settings'}"/>
                            
                    <Button Content="Get Help" 
                            Style="{StaticResource NavigationButtonStyle}" 
                            VerticalAlignment="Bottom"/>
                </StackPanel>
            </Border>
    
            <!-- Content Area -->
            <Border Grid.Column="1" Background="{DynamicResource WindowBackgroundBrush}">
                 <!-- We use a ContentControl bound to the CurrentView property -->
                 <ContentControl Content="{Binding CurrentView}">
                     <ContentControl.Resources>
                         <DataTemplate DataType="{x:Type vm:DashboardViewModel}">
                             <views:DashboardView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:RawDataViewModel}">
                             <views:RawDataView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:CategoryViewModel}">
                             <views:CategoryView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:LimitViewModel}">
                             <views:LimitView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:UserSettingsViewModel}">
                             <views:UserSettingsView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:AllFeaturesViewModel}">
                             <views:AllFeaturesView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:CommunityViewModel}">
                             <views:CommunityView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:ReelsBlockerViewModel}">
                             <views:ReelsBlockerView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:AdultBlockerViewModel}">
                             <views:AdultBlockerView/>
                         </DataTemplate>
                         <DataTemplate DataType="{x:Type vm:PrimeModeViewModel}">
                             <views:PrimeModeView/>
                         </DataTemplate>
                     </ContentControl.Resources>
                 </ContentControl>
            </Border>
        </Grid>
    </Grid>
</Window>
